const Le=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};Le();function _(){}function Ce(t){return t()}function be(){return Object.create(null)}function re(t){t.forEach(Ce)}function Re(t){return typeof t=="function"}function P(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Me(t){return Object.keys(t).length===0}function De(t,...e){if(t==null)return _;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ie(t,e,n){t.$$.on_destroy.push(De(e,n))}function l(t,e){t.appendChild(e)}function A(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode.removeChild(t)}function v(t){return document.createElement(t)}function k(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function S(t){return document.createTextNode(t)}function x(){return S(" ")}function Pe(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function c(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ie(t){return Array.from(t.childNodes)}function C(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function ye(t,e){t.value=e==null?"":e}function I(t,e,n,r){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function $e(t,e,n){t.classList[n?"add":"remove"](e)}let F;function K(t){F=t}function Te(){if(!F)throw new Error("Function called outside component initialization");return F}function je(t){Te().$$.on_mount.push(t)}function We(t){Te().$$.on_destroy.push(t)}const H=[],fe=[],Y=[],de=[],qe=Promise.resolve();let pe=!1;function Je(){pe||(pe=!0,qe.then(Ee))}function he(t){Y.push(t)}function ze(t){de.push(t)}const ce=new Set;let G=0;function Ee(){const t=F;do{for(;G<H.length;){const e=H[G];G++,K(e),He(e.$$)}for(K(null),H.length=0,G=0;fe.length;)fe.pop()();for(let e=0;e<Y.length;e+=1){const n=Y[e];ce.has(n)||(ce.add(n),n())}Y.length=0}while(H.length);for(;de.length;)de.pop()();pe=!1,ce.clear(),K(t)}function He(t){if(t.fragment!==null){t.update(),re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(he)}}const ee=new Set;let Ke;function E(t,e){t&&t.i&&(ee.delete(t),t.i(e))}function j(t,e,n,r){if(t&&t.o){if(ee.has(t))return;ee.add(t),Ke.c.push(()=>{ee.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Fe(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function W(t){t&&t.c()}function B(t,e,n,r){const{fragment:o,on_mount:s,on_destroy:a,after_update:u}=t.$$;o&&o.m(e,n),r||he(()=>{const f=s.map(Ce).filter(Re);a?a.push(...f):re(f),t.$$.on_mount=[]}),u.forEach(he)}function N(t,e){const n=t.$$;n.fragment!==null&&(re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ue(t,e){t.$$.dirty[0]===-1&&(H.push(t),Je(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(t,e,n,r,o,s,a,u=[-1]){const f=F;K(t);const i=t.$$={fragment:null,ctx:null,props:s,update:_,not_equal:o,bound:be(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:be(),dirty:u,skip_bound:!1,root:e.target||f.$$.root};a&&a(i.root);let d=!1;if(i.ctx=n?n(t,e.props||{},(p,m,...h)=>{const g=h.length?h[0]:m;return i.ctx&&o(i.ctx[p],i.ctx[p]=g)&&(!i.skip_bound&&i.bound[p]&&i.bound[p](g),d&&Ue(t,p)),m}):[],i.update(),d=!0,re(i.before_update),i.fragment=r?r(i.ctx):!1,e.target){if(e.hydrate){const p=Ie(e.target);i.fragment&&i.fragment.l(p),p.forEach(T)}else i.fragment&&i.fragment.c();e.intro&&E(t.$$.fragment),B(t,e.target,e.anchor,e.customElement),Ee()}K(f)}class R{$destroy(){N(this,1),this.$destroy=_}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!Me(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const q=[];function X(t,e){return{subscribe:Xe(t,e).subscribe}}function Xe(t,e=_){let n;const r=new Set;function o(u){if(P(t,u)&&(t=u,n)){const f=!q.length;for(const i of r)i[1](),q.push(i,t);if(f){for(let i=0;i<q.length;i+=2)q[i][0](q[i+1]);q.length=0}}}function s(u){o(u(t))}function a(u,f=_){const i=[u,f];return r.add(i),r.size===1&&(n=e(o)||_),u(t),()=>{r.delete(i),r.size===0&&(n(),n=null)}}return{set:o,update:s,subscribe:a}}var J,te=[];function Be(){if(navigator.platform.indexOf("Win")>=0&&(navigator.userAgent.indexOf("Chrome/54")>=0||navigator.userAgent.indexOf("Chrome/55")>=0||navigator.userAgent.indexOf("Chrome/56")>=0))return console.warn("Chrome <56 in Windows has navigator.bluetooth but it's not implemented properly"),confirm(`Web Bluetooth on Windows is not yet available.
Please click Ok to see other options for using Web Bluetooth`)&&(window.location="https://www.espruino.com/Puck.js+Quick+Start"),!1;if(navigator.bluetooth)return!0;console.warn("No Web Bluetooth on this platform");var t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;return t?confirm(`To use Web Bluetooth on iOS you'll need the WebBLE App.
Please click Ok to go to the App Store and download it.`)&&(window.location="https://itunes.apple.com/us/app/webble/id1193531073"):confirm(`This Web Browser doesn't support Web Bluetooth.
Please click Ok to see instructions for enabling it.`)&&(window.location="https://www.espruino.com/Quick+Start+BLE#with-web-bluetooth"),!1}var ue="6e400001-b5a3-f393-e0a9-e50e24dcca9e",Qe="6e400002-b5a3-f393-e0a9-e50e24dcca9e",Ve="6e400003-b5a3-f393-e0a9-e50e24dcca9e",_e=20;function $(t,e){U.log&&U.log(t,e)}function Ze(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function Ge(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0,o=t.length;r<o;r++)n[r]=t.charCodeAt(r);return e}function xe(){if(!!te.length){var t=te.shift();$(3,"Executing "+JSON.stringify(t)+" from queue"),t.type=="write"?U.write(t.data,t.callback,t.callbackNewline):$(1,"Unknown queue item "+JSON.stringify(t))}}function Ne(t){if(!!Be()){var e={on:function(i,d){this["on"+i]=d},emit:function(i,d){this["on"+i]&&this["on"+i](d)},isOpen:!1,isOpening:!0,txInProgress:!1},n=void 0,r,o,s,a=[],u=!1,f=_e;return e.close=function(){e.isOpening=!1,e.isOpen?(e.isOpen=!1,e.emit("close")):t&&t(null),n&&(n.disconnect(),n=void 0,o=void 0,s=void 0,f=_e)},e.write=function(i,d){i&&a.push({data:i,callback:d,maxLength:i.length}),e.isOpen&&!e.txInProgress&&p();function p(){if(u){setTimeout(p,50);return}var m;if(!!a.length){var h=a[0];U.writeProgress(h.maxLength-h.data.length,h.maxLength),h.data.length<=f?(m=h.data,h.data=void 0):(m=h.data.substr(0,f),h.data=h.data.substr(f)),e.txInProgress=!0,$(2,"Sending "+JSON.stringify(m)),o.writeValue(Ge(m)).then(function(){$(3,"Sent"),h.data||(a.shift(),h.callback&&h.callback()),e.txInProgress=!1,p()}).catch(function(g){$(1,"SEND ERROR: "+g),a=[],e.close()})}}},navigator.bluetooth.requestDevice({filters:[{namePrefix:"Puck.js"},{namePrefix:"Pixl.js"},{namePrefix:"MDBT42Q"},{namePrefix:"RuuviTag"},{namePrefix:"iTracker"},{namePrefix:"Thingy"},{namePrefix:"Espruino"},{services:[ue]}],optionalServices:[ue]}).then(function(i){$(1,"Device Name:       "+i.name),$(1,"Device ID:         "+i.id),i.addEventListener("gattserverdisconnected",function(){$(1,"Disconnected (gattserverdisconnected)"),e.close()}),e.device=i,e.reconnect(t)}).catch(function(i){$(1,"ERROR: "+i),e.close()}),e.reconnect=function(i){e.device.gatt.connect().then(function(d){return $(1,"Connected"),n=d,d.getPrimaryService(ue)}).then(function(d){return $(2,"Got service"),r=d,r.getCharacteristic(Ve)}).then(function(d){return s=d,$(2,"RX characteristic:"+JSON.stringify(s)),s.addEventListener("characteristicvaluechanged",function(p){var m=p.target.value,h=Ze(m.buffer);h.length>f&&($(2,"Received packet of length "+h.length+", increasing chunk size"),f=h.length);for(var g=0;g<h.length;g++){var b=h.charCodeAt(g),O=!0;b==19?($(2,"XOFF received => pause upload"),u=!0):b==17?($(2,"XON received => resume upload"),u=!1):O=!1,O&&(h=h.substr(0,g-1)+h.substr(g+1),g--)}$(3,"Received "+JSON.stringify(h)),e.emit("data",h)}),s.startNotifications()}).then(function(){return r.getCharacteristic(Qe)}).then(function(d){o=d,$(2,"TX characteristic:"+JSON.stringify(o))}).then(function(){e.txInProgress=!1,e.isOpen=!0,e.isOpening=!1,J=!1,te=[],i(e),e.emit("open"),e.write()}).catch(function(d){$(1,"ERROR: "+d),e.close()})},e}}var w;function le(t,e,n){if(!Be())return;let r;if(typeof e!="function"&&(n=e,r=new Promise((a,u)=>e=(f,i)=>{i?u(i):a(f)})),J)return $(3,"Busy - adding Puck.write to queue"),te.push({type:"write",data:t,callback:e,callbackNewline:n}),r;var o;function s(){n&&(w.cb=function(i){var d=w.received.indexOf(`
`);if(d>=0){var p=w.received.substr(0,d);w.received=w.received.substr(d+1),w.cb=void 0,o&&clearTimeout(o),o=void 0,e&&e(p),J=!1,xe()}});var a=300,u=n?100:3,f=u;o=setTimeout(function i(){o=void 0,a&&a--,f&&f--,w.hadData&&(f=u),f&&a?o=setTimeout(i,100):(w.cb=void 0,e&&e(w.received),J=!1,xe(),w.received=""),w.hadData=!1},100)}return w&&(w.isOpen||w.isOpening)?(w.txInProgress||(w.received=""),J=!0,w.write(t,s),r):(w=Ne(function(a){if(!a){w=void 0,e&&e(null);return}w.received="",w.on("data",function(u){w.received+=u,w.hadData=!0,w.cb&&w.cb(u)}),w.on("close",function(u){w=void 0}),J=!0,w.write(t,s)}),r)}const U={debug:1,increaseMTU:!0,flowControl:!0,log:function(t,e){t<=this.debug&&console.log("<BLE> "+e)},writeProgress:function(t,e){},connect:Ne,write:le,eval:function(t,e){const n=le("Bluetooth.println(JSON.stringify("+t+`))
`,!0).then(function(r){try{return JSON.parse(r)}catch(o){return $(1,"Unable to decode "+JSON.stringify(r)+", got "+o.toString()),Promise.reject(r)}});return e?void n.then(e,r=>e(null,r)):n},setTime:function(t){var e=new Date,n="setTime("+e.getTime()/1e3+");";n+="if (E.setTimeZone) E.setTimeZone("+e.getTimezoneOffset()/-60+`);
`,le(n,t)},isConnected:function(){return w!==void 0},getConnection:function(){return w},close:function(){w&&w.close()},modal:function(t){var e=document.createElement("div");e.style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;opacity:0.5;z-index:100;background:black;",e.innerHTML='<div style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-family: Sans-Serif;font-size:400%;color:white;">Click to Continue...</div>',e.onclick=function(n){t(),n.preventDefault(),document.body.removeChild(e)},document.body.appendChild(e)}};function Q(t,e){return t.write(`if(1){${e}}
`)}function Ye(t){return new Promise((e,n)=>U.connect(r=>{if(!r){n("Failed to connect");return}let o="";r.on("data",s=>{o+=s;const a=o.split(`
`);o=a.pop();for(const u of a)t(u)}),e(r)}))}async function et(t){return Q(t,`
    (function(){
        const alarms = require("sched").getAlarms();
        Bluetooth.println(JSON.stringify({ t: 'alarms', alarms: alarms }));
    })();
`)}async function tt(t){return Q(t,`
    (function(){
        Bluetooth.println(JSON.stringify({ t: 'temperature', temperature: E.getTemperature() }));
    })();
`)}async function nt(t){return Q(t,`
    (function(){
        Bluetooth.println(JSON.stringify({ t: 'steps', steps: Bangle.getHealthStatus('day').steps }));
    })();
`)}async function rt(t,e){let n=`
    Bangle.setHRMPower(true);
    Bangle.on('HRM', (hrm) => {
      Bluetooth.println(JSON.stringify({ t: 'hrm', hrm: {
        bpm: hrm.bpm,
        confidence: hrm.confidence
      } }));
    });
  `;return e&&(n+=`setTimeout(() => Bangle.setHRMPower(false), ${e})`),Q(t,n)}let z;const ne=new Map;function it(t,e){return ne.set(t,{handleConnect:t,handleMessage:e}),()=>{ne.delete(t)}}function V(t,e,n){return it(e,r=>{r.t===t&&n(r)})}async function ot(t=[]){(!z||z.isOpen)&&(z=await Ye(e=>{let n;try{n=JSON.parse(e)}catch{console.warn("Could not parse message",e);return}console.log("[command]",n);for(const{handleMessage:r}of ne.values())r(n)}));for(const{handleConnect:e}of ne.values())e(z);for(const e of t)e(z)}const st=X([],t=>V("alarms",et,e=>t(e.alarms))),at=X(0,t=>V("temperature",tt,e=>t(e.temperature))),ct=X(0,t=>V("steps",nt,e=>t(e.steps))),ut=X(0,t=>V("status",()=>{},e=>t(e.bat))),lt=X({bpm:0,confidence:0},t=>V("hrm",e=>rt(e,6e4),e=>t(e.hrm)));function ft(t){let e,n,r,o,s,a,u,f,i,d,p,m,h,g;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Next Alarm",o=x(),s=v("div"),a=k("svg"),u=k("path"),f=x(),i=v("span"),d=v("span"),p=S(`:\r
        `),m=v("span"),h=S(`:\r
        `),g=v("span"),c(r,"class","card-title"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"),c(a,"xmlns","http://www.w3.org/2000/svg"),c(a,"class","h-6 w-6"),c(a,"fill","none"),c(a,"viewBox","0 0 24 24"),c(a,"stroke","currentColor"),c(a,"stroke-width","2"),I(d,"--value",t[0]),I(m,"--value",t[1]),I(g,"--value",t[2]),c(i,"class","countdown font-mono text-2xl"),c(s,"class","flex gap-2"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(b,O){A(b,e,O),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(a,u),l(s,f),l(s,i),l(i,d),l(i,p),l(i,m),l(i,h),l(i,g)},p(b,[O]){O&1&&I(d,"--value",b[0]),O&2&&I(m,"--value",b[1]),O&4&&I(g,"--value",b[2])},i:_,o:_,d(b){b&&T(e)}}}function Se(){const t=new Date;return t.getHours()*1e3*60*60+t.getMinutes()*1e3*60+t.getSeconds()*1e3}function dt(t,e,n){let r,o=0,s=0,a=0;const u=st.subscribe(i=>{const d=Se(),m=i.filter(h=>h.on&&h.t>d).sort((h,g)=>h.t-g.t)[0];m?r=m.t:(r=void 0,n(0,o=0),n(1,s=0),n(2,a=0))});let f;return je(()=>{(function i(){if(r!==void 0){let d=r-Se();n(0,o=Math.floor(d/36e5)),d=d-o*36e5,n(1,s=Math.floor(d/6e4)),d=d-s*6e4,n(2,a=Math.floor(d/1e3))}f=setTimeout(i,1e3-Date.now()%1e3)})()}),We(()=>{clearTimeout(f),u()}),[o,s,a]}class pt extends R{constructor(e){super(),L(this,e,dt,ft,P,{})}}function ht(t){let e,n,r,o,s,a,u,f,i,d;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Battery",o=x(),s=v("div"),a=k("svg"),u=k("path"),f=x(),i=S(t[0]),d=S("%"),c(r,"class","card-title"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M13 10V3L4 14h7v7l9-11h-7z"),c(a,"xmlns","http://www.w3.org/2000/svg"),c(a,"class","h-6 w-6"),c(a,"fill","none"),c(a,"viewBox","0 0 24 24"),c(a,"stroke","currentColor"),c(a,"stroke-width","2"),c(s,"class","flex gap-2"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(p,m){A(p,e,m),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(a,u),l(s,f),l(s,i),l(s,d)},p(p,[m]){m&1&&C(i,p[0])},i:_,o:_,d(p){p&&T(e)}}}function mt(t,e,n){let r;return ie(t,ut,o=>n(0,r=o)),[r]}class gt extends R{constructor(e){super(),L(this,e,mt,ht,P,{})}}function vt(t){let e,n,r,o,s,a,u,f=t[0].bpm+"",i,d,p=t[0].confidence+"",m,h;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Heart Rate",o=x(),s=v("div"),a=k("svg"),u=k("path"),i=S(f),d=S(" ("),m=S(p),h=S("%)"),c(r,"class","card-title"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"),c(a,"xmlns","http://www.w3.org/2000/svg"),c(a,"class","h-6 w-6"),c(a,"fill","none"),c(a,"viewBox","0 0 24 24"),c(a,"stroke","currentColor"),c(a,"stroke-width","2"),c(s,"class","flex gap-2"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(g,b){A(g,e,b),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(a,u),l(s,i),l(s,d),l(s,m),l(s,h)},p(g,[b]){b&1&&f!==(f=g[0].bpm+"")&&C(i,f),b&1&&p!==(p=g[0].confidence+"")&&C(m,p)},i:_,o:_,d(g){g&&T(e)}}}function wt(t,e,n){let r;return ie(t,lt,o=>n(0,r=o)),[r]}class bt extends R{constructor(e){super(),L(this,e,wt,vt,P,{})}}function yt(t){let e,n,r,o,s,a,u,f;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Steps",o=x(),s=v("div"),a=k("svg"),u=k("path"),f=S(t[0]),c(r,"class","card-title"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"),c(a,"xmlns","http://www.w3.org/2000/svg"),c(a,"class","h-6 w-6"),c(a,"fill","none"),c(a,"viewBox","0 0 24 24"),c(a,"stroke","currentColor"),c(a,"stroke-width","2"),c(s,"class","flex gap-2"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(i,d){A(i,e,d),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(a,u),l(s,f)},p(i,[d]){d&1&&C(f,i[0])},i:_,o:_,d(i){i&&T(e)}}}function $t(t,e,n){let r;return ie(t,ct,o=>n(0,r=o)),[r]}class _t extends R{constructor(e){super(),L(this,e,$t,yt,P,{})}}function xt(t){let e,n,r,o,s,a,u,f,i=t[0]-6+"",d,p,m,h;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Temperature",o=x(),s=v("div"),a=k("svg"),u=k("path"),f=k("path"),d=S(i),p=S("\u2103 ("),m=S(t[0]),h=S("\u2103)"),c(r,"class","card-title"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"),c(f,"stroke-linecap","round"),c(f,"stroke-linejoin","round"),c(f,"d","M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"),c(a,"xmlns","http://www.w3.org/2000/svg"),c(a,"class","h-6 w-6"),c(a,"fill","none"),c(a,"viewBox","0 0 24 24"),c(a,"stroke","currentColor"),c(a,"stroke-width","2"),c(s,"class","flex gap-2"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(g,b){A(g,e,b),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(a,u),l(a,f),l(s,d),l(s,p),l(s,m),l(s,h)},p(g,[b]){b&1&&i!==(i=g[0]-6+"")&&C(d,i),b&1&&C(m,g[0])},i:_,o:_,d(g){g&&T(e)}}}function St(t,e,n){let r;return ie(t,at,o=>n(0,r=o)),[r]}class Ot extends R{constructor(e){super(),L(this,e,St,xt,P,{})}}async function kt(t,e,n){const r=`require('Storage').write('${e}',${n});`;return Q(t,r)}function Ct(){return new Promise(t=>navigator.geolocation.getCurrentPosition(e=>{t({lat:e.coords.latitude,lon:e.coords.longitude})}))}async function Oe(t,e,n,r){const o=await fetch(`https://api.openweathermap.org/data/2.5/${t}?lat=${e}&lon=${n}&units=metric&appid=${r}`);if(!o.ok)throw new Error("Failed to fetch data");return o.json()}function ke(t){return{dt:t.dt*1e3,temp:t.main.temp,weather:t.weather[0].main,icon:t.weather[0].icon}}async function Pt(t,e){localStorage.setItem("weather-api-key",e);const{lat:n,lon:r}=await Ct(),o=await Oe("forecast",n,r,e),s=await Oe("weather",n,r,e),a=[ke(s),...o.list.map(ke)],u={city:o.city.name,sunrise:o.city.sunrise,sunset:o.city.sunset},f={weather:a,location:u};await kt(t,"my-clock-3.app.json",JSON.stringify(f))}function Tt(t){let e,n,r,o,s,a,u,f,i,d;return{c(){e=v("div"),n=v("div"),r=v("h2"),r.textContent="Weather",o=x(),s=v("div"),a=v("label"),a.innerHTML='<span class="label-text">API Key</span>',u=x(),f=v("input"),c(r,"class","card-title"),c(a,"class","label"),c(f,"class","input input-bordered w-full"),c(f,"type","text"),c(s,"class","form-control"),c(n,"class","card-body"),c(e,"class","card w-96 bg-base-100 shadow-xl")},m(p,m){A(p,e,m),l(e,n),l(n,r),l(n,o),l(n,s),l(s,a),l(s,u),l(s,f),ye(f,t[0]),i||(d=Pe(f,"input",t[1]),i=!0)},p(p,[m]){m&1&&f.value!==p[0]&&ye(f,p[0])},i:_,o:_,d(p){p&&T(e),i=!1,d()}}}function Et(t,e,n){let{apiKey:r}=e;function o(){r=this.value,n(0,r)}return t.$$set=s=>{"apiKey"in s&&n(0,r=s.apiKey)},[r,o]}class Bt extends R{constructor(e){super(),L(this,e,Et,Tt,P,{apiKey:0})}}function Nt(t){let e,n,r,o,s,a,u,f,i,d,p,m,h,g,b,O=t[0]?"Syncing...":"Sync",oe,me,Z,se,M,ae,ge;function Ae(y){t[4](y)}let ve={};return t[1]!==void 0&&(ve.apiKey=t[1]),n=new Bt({props:ve}),fe.push(()=>Fe(n,"apiKey",Ae)),s=new pt({}),u=new Ot({}),i=new _t({}),p=new bt({}),h=new gt({}),{c(){e=v("div"),W(n.$$.fragment),o=x(),W(s.$$.fragment),a=x(),W(u.$$.fragment),f=x(),W(i.$$.fragment),d=x(),W(p.$$.fragment),m=x(),W(h.$$.fragment),g=x(),b=v("button"),oe=S(O),me=x(),Z=v("div"),se=S(t[2]),c(b,"class","btn btn-primary"),$e(b,"loading",t[0]),c(Z,"class","alert"),c(e,"class","flex flex-col justify-center items-center gap-8 p-10")},m(y,D){A(y,e,D),B(n,e,null),l(e,o),B(s,e,null),l(e,a),B(u,e,null),l(e,f),B(i,e,null),l(e,d),B(p,e,null),l(e,m),B(h,e,null),l(e,g),l(e,b),l(b,oe),l(e,me),l(e,Z),l(Z,se),M=!0,ae||(ge=Pe(b,"click",t[3]),ae=!0)},p(y,[D]){const we={};!r&&D&2&&(r=!0,we.apiKey=y[1],ze(()=>r=!1)),n.$set(we),(!M||D&1)&&O!==(O=y[0]?"Syncing...":"Sync")&&C(oe,O),D&1&&$e(b,"loading",y[0]),(!M||D&4)&&C(se,y[2])},i(y){M||(E(n.$$.fragment,y),E(s.$$.fragment,y),E(u.$$.fragment,y),E(i.$$.fragment,y),E(p.$$.fragment,y),E(h.$$.fragment,y),M=!0)},o(y){j(n.$$.fragment,y),j(s.$$.fragment,y),j(u.$$.fragment,y),j(i.$$.fragment,y),j(p.$$.fragment,y),j(h.$$.fragment,y),M=!1},d(y){y&&T(e),N(n),N(s),N(u),N(i),N(p),N(h),ae=!1,ge()}}}function At(t,e,n){var f;let r=!1,o=(f=localStorage.getItem("weather-api-key"))!=null?f:"",s="Ready";async function a(){ot([async i=>{n(0,r=!0);try{await Pt(i,o),n(2,s="Success.")}catch{n(2,s="Failed.")}finally{n(0,r=!1)}}])}function u(i){o=i,n(1,o)}return[r,o,s,a,u]}class Lt extends R{constructor(e){super(),L(this,e,At,Nt,P,{})}}new Lt({target:document.getElementById("app")});
